define("common:widget/ui/imghelper/imghelper",function(h){var t=h("common:widget/ui/base/base"),i={_loaded:{},_loading:{},fetch:function(h){var i=new t.Deferred;if(this._loaded[h])return i.resolve(this._loaded[h]);if(this._loading[h])return this._loading[h];var e=new Image,n=this;return e.onload=function(){var t={width:e.width,height:e.height};n._loaded[h]=t,i.resolve(t)},e.onerror=function(){i.reject()},this._loading[h]=i,e.src=h,i.always(function(){e.onload=e.onerror=null,delete n._loading[h],e=null})}},e={zoom:function(h,t){if(!(h.width&&h.height&&t.width&&t.height))return{width:h.width&&t.width?Math.min(t.width,h.width):"auto",height:h.height&&t.height?Math.min(t.height,h.height):"auto"};var i={};return h.width/h.height>t.width/t.height?(i.width=Math.min(h.width,t.width),i.height=Math.floor(h.height*i.width/h.width)):(i.height=Math.min(h.height,t.height),i.width=Math.floor(h.width*i.height/h.height)),i},scaleFull:function(h,t){if(!(h.width&&h.height&&t.width&&t.height))return{width:h.width&&t.width?Math.min(t.width,h.width):"auto",height:h.height&&t.height?Math.min(t.height,h.height):"auto"};var i={};return h.width/h.height>t.width/t.height?(i.height=t.height,i.width=Math.floor(h.width*i.height/h.height)):(i.width=t.width,i.height=Math.floor(h.height*i.width/h.width)),i.width>t.width&&(i["margin-left"]=(t.width-i.width)/2+"px"),i.height>t.height&&(i["margin-top"]=(t.height-i.height)/3+"px"),i},getFileType:function(h){if(!h)return"";var t=h.lastIndexOf(".");return t>0?h.substr(t+1):""},formatBytes:function(h,t,i){var e=["b","kb","mb","gb"],n=h;for(t=t||0;n>=1024&&t<e.length-1;)n/=1024,t+=1;return t>0&&(n=Math.round(100*n)/100),i&&(n=i.call(null,n)),n+e[t]},bindScaleFull:function(h,t,i){var n=h[0];n.onload=function(){var n=e._imgLoaded(h,t);i&&i(n)}},_imgLoaded:function(h,t){var i=h[0],n=e.scaleFull({width:i.width,height:i.height},t);return h.css(n),i.onload=null,n},loadImage:function(h,e){t(h).each(function(h,t){i.fetch(t).then(e||function(){})})}};return e});