;/*!searchdetail:widget/old/hotInfo/utils/utils.js*/
define("searchdetail:widget/old/hotInfo/utils/utils",function(t,n,r){var e=function(){function t(t,n,r,e){var a,i,o,h;return t/n>=r/e?(a=Math.min(t,r),i=a*n/t):(i=Math.min(n,e),a=i*t/n),o=(r-a)/2,h=(e-i)/2,{width:parseInt(a),height:parseInt(i),left:parseInt(o),top:parseInt(h)}}function n(t,n,r,e,a){var i,o,h,s;return t/n>=e/a?(o=Math.max(Math.min(n,a),r),i=o*t/n):(i=Math.max(Math.min(t,e),r),o=i*n/t),h=(e-i)/2,s=(a-o)/2,{width:parseInt(i),height:parseInt(o),left:parseInt(h),top:parseInt(s)}}function r(t){var n="";for(var r in t)r&&t.hasOwnProperty(r)&&(n+="&"+r+"="+t[r]);return n}function e(t){var n={};t=t.replace(/^\?+/,"");for(var r,e,a=t.split("&"),i=0,o=a.length;o>i;i++)e=a[i],r=e.split("="),n[r[0]]=r[1];return n}function a(t){var n=t.match(/^(https?:\/\/[^\/]+)(\/|$)/i);return n&&n.length&&n[1]}return{getHost:a,zoomImage:t,zoomLimitMinLength:n,json2Query:r,query2JSON:e}}();r.exports=e});
;/*!searchdetail:widget/old/hotInfo/ParamsBus/ParamsBus.js*/
define("searchdetail:widget/old/hotInfo/ParamsBus/ParamsBus",function(t,e,n){var r=t("searchdetail:widget/old/hotInfo/utils/utils"),o=function(){function t(t){return o[t]||""}function e(t){return i[t]}function n(t){var e="/";if($.trim(t.set_from_url))e=t.set_from_url;else{var n=_.clone(o);n.set_id=t.set_id,n.pn="0",n.rn=t.pic_num,e="/search/acjson?"+r.json2Query(n)}return e}var o,i=window.tplConf,s=location.search.substring(1);return o=r.query2JSON(s),{getSearchConfItem:t,getTplConfItem:e,getDetailURL:n}}();n.exports=o});
;/*!searchdetail:widget/old/hotInfo/common/Mask/Mask.js*/
define("searchdetail:widget/old/hotInfo/common/Mask/Mask",function(e,i,n){var t={className:"ui-component-mask"},o=Backbone.View.extend({initialize:function(e){this.config=_.extend(_.clone(t),e||{})},render:function(){var e=$('<div style="display:none; " class="'+this.config.className+'"></div>').appendTo(document.body);this.$el=e,this._setupEvent()},_setupEvent:function(){var e=this;this.$el.on("click",function(){e.trigger("click",{})})},show:function(){this.$el.show()},hide:function(){this.$el.hide()}});n.exports=o});
;/*!searchdetail:widget/old/hotInfo/common/Dialog/Dialog.js*/
define("searchdetail:widget/old/hotInfo/common/Dialog/Dialog",function(t,i,e){var h=t("searchdetail:widget/old/hotInfo/common/Mask/Mask"),s={modal:!0,hideOnMaskClick:!0,autoCenter:!0,maskConfig:{}},n=Backbone.View.extend({initialize:function(t){var i=_.extend(_.clone(s),t||{});this.$el=$(i.el),this.config=i,i.modal&&(this.mask=new h(i.maskConfig)),this.render()},render:function(){return this.mask&&this.mask.render(),this._setupEvent(),this},_setupEvent:function(){var t=this;return this.mask&&this.config.hideOnMaskClick&&this.mask.on("click",function(){t.hide()}),this},show:function(){this.trigger("before-show"),this.config.autoCenter&&this.center(),this.$el.show(),this.mask&&this.mask.show(),this.trigger("after-show")},hide:function(){this.trigger("before-hide"),this.$el.hide(),this.mask&&this.mask.hide(),this.trigger("after-hide")},setInnerHTML:function(t){return this.$el.html(t),this},center:function(){var t=this.getWidth(),i=this.getHeight(),e=document.body.scrollLeft,h=document.body.scrollTop,s=$(window),n=s.width(),o=s.height();return this.$el.css({left:e+(n-t)/2,top:h+(o-i)/2}),this},getWidth:function(){return this.config.width||this.$el.width()},getHeight:function(){return this.config.height||this.$el.height()}});e.exports=n});
;/*!searchdetail:widget/old/hotInfo/model/dataStore/dataStore.js*/
define("searchdetail:widget/old/hotInfo/model/dataStore/dataStore",function(t,n,e){var a=function(){function t(t){l=t.listNum}function n(t,n,a,i){return t=Math.max(v,t),n=Math.max(0,n),a=a!==!1,s=function(){"function"==typeof i&&i.call(window,m)},e(t,t+n,a),a?void 0:m}function e(t,n,e){"number"==typeof l&&(t=Math.min(Math.abs(t),l-1),n=Math.min(Math.abs(n),l-1),n=Math.max(t,n));var i=f(t,n),o=f(t,n,M);d=i.concat(o),i.length>0?a(i,e):d.length<1&&"function"==typeof s&&s()}function a(t,n){t.length<1&&s();for(var e=0,a=t.length;a>e;e++)i(t[e],n)}function i(t){var n=p*t,e=b,a=r(n,p);a+="&callback=?&_=[TIMESTAMP]",$.ajax({url:a,dataType:"jsonp",success:function(n){e===b&&o(t,n,!0)},error:function(){alert("jsonp error"),g[t]=void 0}}),g[t]=M}function o(t,n,e){l=n.listNum;var a,i=t*p,o=n.data;o.splice(o.length-1,1);for(var r=0;p>r&&(a=o[r],a);r++)a.iwidth=a.width,a.iheight=a.height,delete a.width,delete a.height,m[i+r]=a;if(g[t]=w,e===!0&&d&&d.length>0){for(var f=!0,r=0,h=d.length;h>r;r++)if(g[d[r]]!==w){f=!1;break}f&&"function"==typeof s&&s()}}function r(t,n){return"http://image.baidu.com/search/acjson?tn=resultjson&ct=201326592&cl=2&lm=-1&st=-1&sf=1&fmq=1369151285210_R&pv=&ic=8&nc=1&z=&se=1&showtab=0&fb=0&width=&height=&face=0&istype=2&ie=gbk&word=%B1%DA%D6%BD&pn="+t+"&oe=utf-8&rn="+n}function f(t,n,e){for(var a=[],i=Math.floor(t/p),o=Math.ceil(n/p),r=i;o>r;r++)g[r]===e&&a.push(r);return a}function h(){return l}function c(t,n,e){n=n||0,e=e===!0;var a,i=t.length;if(p>i&&l>i)return!1;for(var o=f(n,n+i),a=n,i=Math.min(i,l);i>a;a++){var r=u(t[a]);m[a]=r}for(a=0,i=o.length;i>a;a++)g[o[a]]=w}function u(t){return t}var l,s,d,g=[],m=[],v=0,p=60,M=1,w=2,b=(new Date).getTime()*Math.random();return{getData:n,getTotalNum:h,insertData:c,init:t}}();e.exports=a});
;/*!searchdetail:widget/old/hotInfo/sizeHandler/sizeHandler.js*/
define("searchdetail:widget/old/hotInfo/sizeHandler/sizeHandler",function(e,i,n){var t=function(){function e(){var e=o.width(),a=o.height(),d=r?t:25,c=a-i-d-n,l=e;return{containerWidth:e,containerHeight:a,sliderWidth:l,sliderHeight:c,carouselWidth:e-300}}var i=60,n=48,t=135,r=!0,o=$(window);return Backbone.on("carousel-toggle",function(e){r=e.visible}),{calculateSize:e}}();n.exports=t});
;/*!searchdetail:widget/old/hotInfo/statistic/monitorRequest.js*/
define("searchdetail:widget/old/hotInfo/statistic/monitorRequest",function(e,t,i){i.exports=function(){var e=(new Date).getTime();return function(t){var i=window["__log__"+(new Date).getTime()]=document.createElement("img"),n="",a=(new Date).getTime();n="lsTime="+(a-e),e=a;t.replace("webclick.baidu.com","imgstat.baidu.com");return i.src=t+"&"+n+"&"+new Date*Math.random(),i.src}}()});
;/*!searchdetail:widget/old/hotInfo/statistic/statistic.js*/
define("searchdetail:widget/old/hotInfo/statistic/statistic",function(e,t,o){var n=e("searchdetail:widget/old/hotInfo/utils/utils"),i=e("searchdetail:widget/old/hotInfo/ParamsBus/ParamsBus"),a=e("searchdetail:widget/old/hotInfo/statistic/monitorRequest"),r=300,l=i.getSearchConfItem("word"),d=i.getSearchConfItem("ie"),s="//imgstat.baidu.com/5.gif?fm=infodetail&_dev=pc&logid="+window.logid,u=(new Date).getTime(),c=function(e,t){var o=(new Date).getTime(),i=o-u;u=o;var c,w=e.async||!1;w&&e.url&&(c=e.url,delete e.async,delete e.url,t=t||window.event),e.word=l,e.ie=d,e.activetm=i,e.userid=BD.IMG.tplConf.encodeUserNumId;var f=(n.json2Query(e),"log_"+(new Date).getTime()*Math.random()),g=window[f]=new Image;g.onload=g.onerror=function(){g.onload=g.onerror=null,window[f]=null,g=null},a(s),w&&c&&setTimeout(function(){location.href=c},r),w&&t&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!0,t.returnValue=!1))};o.exports=window.p=c});
;/*!searchdetail:widget/old/hotInfo/views/CarouselView/CarouselView.js*/
define("searchdetail:widget/old/hotInfo/views/CarouselView/CarouselView",function(t,e,i){var s=Backbone.View.extend({$wrap:null,$listWrap:null,$listContainer:null,$preBtn:null,$nextBtn:null,selectedIndex:-1,autoBlock:0,targetTopIndex:null,topIndex:null,visibleNum:0,totalNum:0,getData:null,getBlockHTML:null,getBlockInnerHTML:null,initialize:function(t){var e=_.extend(_.clone(s.defaultConfig),t||{});if("function"!=typeof e.getData)throw new Error("CarouselView 必须传入一个getData方法！");this.SWITCH_BTN_LENGTH=e.SWITCH_BTN_LENGTH,this.ITEM_WIDTH=e.ITEM_WIDTH,this.ITEM_INNER_WIDTH=e.ITEM_INNER_WIDTH,this.ITEM_MARGIN=e.ITEM_MARGIN,this.ITEM_CLASS=e.ITEM_CLASS,this.ITEM_EMPTY_CLASS=e.ITEM_EMPTY_CLASS,this.ITEM_SELECT_CLASS=e.ITEM_SELECT_CLASS,this.duration=e.duration,this.preCacheNum=e.preCacheNum,this.nextCacheNum=e.nextCacheNum,this.displayPosition=e.displayPosition,this.getDisplayPosition=e.getDisplayPosition,this.getData=e.getData,this.getBlockHTML=e.getBlockHTML,this.getBlockInnerHTML=e.getBlockInnerHTML,this.$wrap=$(e.wrap),this.$listWrap=$(e.listWrap),this.$listContainer=$(e.listContainer),this.$preBtn=$(e.preBtn),this.$nextBtn=$(e.nextBtn),this.totalNum=e.totalNum,this.selectedIndex=e.selectedIndex||0,this.targetTopIndex=this.topIndex=-this.preCacheNum,this.setupEvent()},setupEvent:function(){var t=this,e=function(){t.autoBlock=0};this.$preBtn.mousedown(function(){t.canSwitch()&&(t.autoBlock=-t.visibleNum,t.gotoPre())}).mouseup(e).mouseout(e),this.$nextBtn.mousedown(function(){t.canSwitch()&&(t.autoBlock=t.visibleNum,t.gotoNext())}).mouseup(e).mouseout(e);var i=this.ITEM_CLASS;this.$listContainer.delegate("."+i,"click",function(e){if(t.canSwitch()){var s=$(e.target);if(s.hasClass(i)||(s=s.parent("."+i)),s){var n=parseInt(s.attr("data-index"));n>=0&&n<t.totalNum&&(t.switchTo(n),t.trigger("item-click",{index:n}))}}})},gotoNext:function(){if(this.targetTopIndex===this.topIndex&&this.autoBlock>0&&(this.targetTopIndex=this.validateTopIndex(this.topIndex+this.autoBlock)),this.targetTopIndex>this.topIndex){var t=$("."+this.ITEM_CLASS+":first",this.$listContainer),e=this.topIndex,i=this;t.animate({width:0},{easing:"linear",duration:this.duration,complete:function(){if(e===i.topIndex){i.topIndex+=1;var s=i.calcEndIndex();i.getData(s,function(e){t.css("width",i.ITEM_INNER_WIDTH).attr("data-index",s),s>=i.totalNum||0>s||!e?t.addClass(i.ITEM_EMPTY_CLASS).html(""):t.removeClass(i.ITEM_EMPTY_CLASS).html(i.getBlockInnerHTML(s)),s===i.selectedIndex?t.addClass(i.ITEM_SELECT_CLASS):t.removeClass(i.ITEM_SELECT_CLASS),i.$listContainer.append(t),i.gotoNext()})}}})}else this.autoBlock=0},gotoPre:function(){if(this.targetTopIndex===this.topIndex&&this.autoBlock<0&&(this.targetTopIndex=this.validateTopIndex(this.topIndex+this.autoBlock)),this.targetTopIndex<this.topIndex){var t=this.topIndex-1,e=this.ITEM_CLASS,i="",s=this.topIndex,n=this;0>t||t>=this.totalNum?(e+=" "+this.ITEM_EMPTY_CLASS,i=" "+this.ITEM_SELECT_CLASS):t===this.selectedIndex?e+=" "+this.ITEM_SELECT_CLASS:i=this.ITEM_EMPTY_CLASS+" "+this.ITEM_SELECT_CLASS,this.getBlockInnerHTML(t,function(o){var a=$("."+n.ITEM_CLASS+":last",n.$listContainer).css({width:0}).html(o).attr("data-index",t).removeClass(i).addClass(e).prependTo(n.$listContainer);a.animate({width:n.ITEM_INNER_WIDTH},{easing:"linear",duration:n.duration,complete:function(){s===n.topIndex&&(n.topIndex=t,n.gotoPre())}})})}else this.autoBlock=0},forward:function(){this.canSwitch()&&(this.targetTopIndex=this.validateTopIndex(this.topIndex+1),this.gotoNext())},backward:function(){this.canSwitch()&&(this.targetTopIndex=this.validateTopIndex(this.topIndex-1),this.gotoPre())},forwardOnePage:function(){this.canSwitch()&&(this.targetTopIndex=this.validateTopIndex(this.topIndex+this.visibleNum),this.gotoNext())},backwardOnePage:function(){this.canSwitch()&&(this.targetTopIndex=this.validateTopIndex(this.topIndex-this.visibleNum),this.gotoPre())},switchTo:function(t){t=parseInt(t);var e=this.selectedIndex,i=this;if(t>=0&&t<this.totalNum&&t!==e)if(setTimeout(function(){i.selectChange()},15),Math.abs(t-e)>=this.visibleNum||t<this.topIndex||t>this.topIndex+this.preCacheNum+this.visibleNum+this.nextCacheNum-1)this.selectedIndex=t,this.resetHTML();else{this.targetTopIndex=this.calcTopIndex(t);var s=t>e;this.selectedIndex=t,s?this.gotoNext():this.gotoPre(),this.$listContainer.children("."+this.ITEM_SELECT_CLASS).removeClass(this.ITEM_SELECT_CLASS),this.$listContainer.children("[data-index="+t+"]").addClass(this.ITEM_SELECT_CLASS)}},selectChange:function(){this.trigger("selectChange",{selectedIndex:this.selectedIndex,visibleNum:this.visibleNum,totalNum:this.totalNum})},resize:function(t){var e=t.width-2*this.SWITCH_BTN_LENGTH,i=Math.ceil(e/(this.ITEM_MARGIN+this.ITEM_WIDTH));e=i*(this.ITEM_MARGIN+this.ITEM_WIDTH);var s=e+2*this.SWITCH_BTN_LENGTH;this.visibleNum=i,this.autoBlock=0,"function"==typeof this.getDisplayPosition&&(this.displayPosition=this.getDisplayPosition(i)),this.$wrap.css({width:s}),this.$listWrap.css({width:e}),this.resetHTML()},resetHTML:function(){this.topIndex=this.calcTopIndex(this.selectedIndex),this.targetTopIndex=this.topIndex;for(var t,e=this.topIndex,i=this.selectedIndex,s="",n=0,o=this.preCacheNum+this.visibleNum+this.nextCacheNum;o>n;n++)t=n+e,s+=this.getBlockHTML(t,i);this.$listContainer.html(s)},canSwitch:function(){return this.targetTopIndex===this.topIndex&&0===this.autoBlock},validateTopIndex:function(t){return t=Math.min(t,this.totalNum+1-this.preCacheNum-this.visibleNum),t=Math.max(-this.preCacheNum,t)},calcTopIndex:function(t){var e=t-this.displayPosition+1-this.preCacheNum;return this.validateTopIndex(e)},calcEndIndex:function(){return this.topIndex+this.preCacheNum+this.visibleNum+this.nextCacheNum-1}});s.defaultConfig={SWITCH_BTN_LENGTH:70,ITEM_WIDTH:100,ITEM_INNER_WIDTH:96,ITEM_MARGIN:5,ITEM_CLASS:"carousel-item",ITEM_EMPTY_CLASS:"carousel-item-empty",ITEM_SELECT_CLASS:"carousel-item-select",duration:100,preCacheNum:1,nextCacheNum:1,displayPosition:2},i.exports=s});
;/*!searchdetail:widget/old/hotInfo/views/infoManager/infoManager.js*/
define("searchdetail:widget/old/hotInfo/views/infoManager/infoManager",function(i,t,n){var e=function(){function i(i){o=i.listNum,r=$("#pic-digest"),c=$("#index-info"),a=$("#pic-from-com"),f=$("#news-info"),s=$("#bdshare"),$picSiteWrap=$(".pic-site-wrap","#pic-info"),t()}function t(){a.click(function(){p({type:"furl",action:"click",pos:"toplink"})})}function n(){}function e(i){r.html(i.shortDigest),c.html('<span class="current-pn">'+(i.pageNum+1)+"</span>/"+o),$.trim(i.fromSite)?(a.html(i.fromSite).attr("href",i.fromURL),$picSiteWrap.show()):$picSiteWrap.hide(),f.html(i.longDigest),s.attr("data","{'pic':'"+i.objURL+"'}")}var o,r,c,a,f,s;return{init:i,resize:n,update:e}}();n.exports=e});
;/*!searchdetail:widget/old/hotInfo/views/recommendPopup/recommendPopup.js*/
define("searchdetail:widget/old/hotInfo/views/recommendPopup/recommendPopup",function(e,t,i){var n=e("searchdetail:widget/old/hotInfo/common/Dialog/Dialog"),o=e("searchdetail:widget/old/hotInfo/statistic/statistic"),a=e("searchdetail:widget/old/hotInfo/utils/utils"),s=e("searchdetail:widget/old/hotInfo/ParamsBus/ParamsBus"),r=function(){function e(e){m=$("#last-page-popup"),d=new n({el:m,width:720,height:445});for(var i,o,a=e.setCoverData,s=0,r=a.length;r>s;s++)o=a[s],i=o.cover_pic,k.push({set_id:o.set_id,set_title:o.set_title,pic_num:o.pic_num,thumbURL:i.tn_330_url,width:i.tn_330_width,height:i.tn_330_height,set_from_url:o.set_from_url});w=e.listNum,t()}function t(){$(".reset-view-btn",m).click(function(){var e=k[0];if(e){var t=s.getDetailURL(e);o({async:!0,url:t,action:"click",pos:"resetbtn"})}else Backbone.trigger("reset-index"),u(),o({page:"infodetail",action:"click",pos:"resetbtn"})}),$(".view-more-btn",m).click(function(){var e="/search/index?tn=baiduimage&ct=201326592&cl=2&fm=newsdetail&word="+s.getSearchConfItem("word")+"&ie="+s.getSearchConfItem("ie");o({page:"infodetail",action:"click",pos:"viewmore",async:!0,url:e})})}function i(e){e&&(f=e.pageNum,e.pageNum!==w-1||g||(g=setTimeout(p,0)))}function r(){d.center()}function p(e){k&&k.length>0&&!v||(k=[],"function"==typeof e&&e())}function c(){if(!v){for(var e,t,i,n,o,r="",p=Math.min(k.length,8),c=0;p>c;c++)e=k[c],o=0,e.set_from_url?(i="_blank",n=!1,o=1):(i="_self",n=!0),t=a.zoomLimitMinLength(e.width,e.height,150,150,150),e.renderWidth=t.width,e.renderHeight=t.height,e.renderLeft=t.left,e.renderTop=0,e.target=i,e.async=n,e.is_out=o,e.link=s.getDetailURL(e),r+=b(e);$(".popup-content","#last-page-popup").html(r),v=!0}}function l(){f===w-1&&k&&k.length>=1&&(c(),d.show(),o({page:"infodetail",action:"show",pos:"popup"}))}function h(){k&&k.length>0?l():p(l)}function u(){d.hide()}var d,f,g,m,w=0,v=!1,k=[],b=_.template('<a onclick="p({page:\'infodetail\', type:\'click\', pos:\'popupthumb\', is_out:\'<%= is_out %>\', async:<%= async %>, url:this.href}, event);" class="popup-item-wrap" target="<%= target %>" href="<%= link %>"><img style="width:<%= renderWidth %>px; height:<%= renderHeight %>px; top:<%= renderTop %>px; left:<%= renderLeft %>px;" src="<%= thumbURL %>" /><p class="popup-set-info"><span class="popup-set-num"><%= pic_num %>张</span><span class="popup-set-name"><%= set_title %></span></p></a>');return{init:e,update:i,resize:r,show:h,hide:u}}();i.exports=r});
;/*!searchdetail:widget/old/hotInfo/views/slider/slider.js*/
define("searchdetail:widget/old/hotInfo/views/slider/slider",function(t,i,e){var n=t("searchdetail:widget/old/hotInfo/utils/utils"),c=t("searchdetail:widget/old/hotInfo/statistic/statistic"),o=function(){function t(t){r=$("#slider-container"),l=$("#slider-pic-con"),p=$(".slider-btn-pre","#slider-container"),g=$(".slider-btn-next","#slider-container"),a=t.listNum,i(),d=l.children("img")}function i(){p.click(function(){Backbone.trigger("slider-switch",{action:"pre"}),f&&f.pageNum>0&&c({type:"picswitch",action:"click",pos:"prebtn",pn:f.pageNum,total:a})}),g.click(function(){Backbone.trigger("slider-switch",{action:"next"}),f&&f.pageNum<a-1&&c({type:"picswitch",action:"click",pos:"nextbtn",pn:f.pageNum,total:a})}),l.delegate("img","click",function(){f&&(window.open(f.fromURL),c({type:"furl",action:"click",pos:"bigpic"}))})}function e(t){f=t;var i=n.zoomImage(f.iwidth,f.iheight,b,k);d.hide().attr("src",t.objURL).css({width:i.width+"px",height:i.height+"px",left:i.left+"px",top:i.top+"px"}),x?(d.show(300),x=!1):d.fadeIn()}function o(t){r.css({width:t.width,height:t.height}),h(t),l.css({width:b,height:k}),s()}function h(t){b=Math.max(t.width-2*u,0),k=Math.max(t.height-w-m,0)}function s(){if(f){var t=n.zoomImage(f.iwidth,f.iheight,b,k);return d.css({width:t.width,height:t.height,top:t.top,left:t.left}),t}}var a,r,d,l,p,g,f,u=100,w=15,m=15,x=!0,b=0,k=0;return{init:t,update:e,resize:o}}();e.exports=o});