define("common:widget/ui/arch/behavior/animation",function(t){function e(t,e){this.frames=t,this.options=a.extend({iterationCount:1},e),this._state={repeat:0,animatePro:null,ing:!1}}function n(t,e){var n={};return a(t).each(function(t,i){n[i]=e[i]||0}),n}function i(t){this.element=a(t),this.styles={}}var a=t("common:widget/ui/base/base"),o=t("common:widget/ui/utils/utils"),r=t("common:widget/ui/base/events"),s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/(a.browser.msie?30:60))}}(),u={animate:function(t,e,n,i){var o,r=new a.Deferred;return o=arguments.length>3||!a.isPlainObject(n)?{speed:n,easing:i}:a.extend({},n),o.always=function(){r.resolve()},a(t).animate(e,o),r},create:function(t){return new i(t)},frame:function(t){s.call(window,t)},keyframes:function(t,n){return new e(t,n).start()}};a.extend(e.prototype,r,{start:function(){if(!this._state.ing){var t=this;this._doAnimate().then(function(){t._state.ing=!1,t._state.repeat=0,t._state.animatePro=null,t.fire("done")})}return this},_doAnimate:function(){this._state.ing=!0,this._state.animatePro=this._state.animatePro||new a.Deferred;var t=this;return this._state.repeat<this.options.iterationCount?this._doAnimateOnce().then(function(){t._state.repeat+=1,t._doAnimate()}):this._state.animatePro&&this._state.animatePro.resolve(),this._state.animatePro},_doAnimateOnce:function(){var t=new a.Deferred,e=this,n=this.frames.length,i=0,o=function(){n>i?(frm=e.frames[i],u.animate.apply(u,frm).then(function(){i+=1,o()})):t.resolve()};return o(),t},stop:function(){return this._state.ing&&(this._state.repeat=1/0),this}});var m={},d={slide:["margin-bottom","border-bottom-width","padding-bottom","height","padding-top","border-top-width","margin-top"],pull:["margin-right","border-right-width","padding-right","width","padding-left","border-left-width","margin-left"]},h={slideDown:"slide",slideUp:"slide",pullOn:"pull",pushOff:"pull",expand:"expand",collapse:"expand"};return d.expand=[].concat(d.slide,d.pull),a(["slideDown","pullOn","expand"]).each(function(t,e){m[e]=function(t,i){return this.animate(n(d[h[e]],this.styles),t,i)}}),a(["slideUp","pushOff","collapse"]).each(function(t,e){m[e]=function(t,i){return this.animate(n(d[h[e]],{}),t,i)}}),a.extend(i.prototype,m,{init:function(){var t=this.styles,e=this.element;return a(d.expand).each(function(n,i){t[i]=o.UI.getCssDigitValue(e,i)}),this},animate:function(t,e,n){return u.animate(this.element,t,e,n)}}),u});